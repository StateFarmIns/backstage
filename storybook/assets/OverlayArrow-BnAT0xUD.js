import{j,$ as ue,d as pe}from"./utils-DHGDFEAl.js";import{r as E,H as me,a4 as ve}from"./iframe-B5rMEWCp.js";import{t as ge,b as $e}from"./useFocusRing-Dk8-PtBk.js";import{$ as he}from"./context-xsLMgyV1.js";import{$ as be}from"./useControlledState-DLEwl9TE.js";function xe(){return typeof window.ResizeObserver<"u"}function D(t){const{ref:e,box:l,onResize:n}=t;E.useEffect(()=>{let o=e?.current;if(o)if(xe()){const r=new window.ResizeObserver(c=>{c.length&&n()});return r.observe(o,{box:l}),()=>{o&&r.unobserve(o)}}else return window.addEventListener("resize",n,!1),()=>{window.removeEventListener("resize",n,!1)}},[n,e,l])}function Ye(t,e=!0){let[l,n]=E.useState(!0),o=l&&e;return j(()=>{if(o&&t.current&&"getAnimations"in t.current)for(let r of t.current.getAnimations())r instanceof CSSTransition&&r.cancel()},[t,o]),ie(t,o,E.useCallback(()=>n(!1),[])),o}function Be(t,e){let[l,n]=E.useState(e?"open":"closed");switch(l){case"open":e||n("exiting");break;case"closed":case"exiting":e&&n("open");break}let o=l==="exiting";return ie(t,o,E.useCallback(()=>{n(r=>r==="exiting"?"closed":r)},[])),o}function ie(t,e,l){j(()=>{if(e&&t.current){if(!("getAnimations"in t.current)){l();return}let n=t.current.getAnimations();if(n.length===0){l();return}let o=!1;return Promise.all(n.map(r=>r.finished)).then(()=>{o||me.flushSync(()=>{l()})}).catch(()=>{}),()=>{o=!0}}},[t,e,l])}function J(t,e=-1/0,l=1/0){return Math.min(Math.max(t,e),l)}const M={top:"top",bottom:"top",left:"left",right:"left"},U={top:"bottom",bottom:"top",left:"right",right:"left"},we={top:"left",left:"top"},K={top:"height",left:"width"},ae={width:"totalWidth",height:"totalHeight"},Z={};let C=typeof document<"u"?window.visualViewport:null;function ee(t){let e=0,l=0,n=0,o=0,r=0,c=0,i={};var h;let d=((h=C?.scale)!==null&&h!==void 0?h:1)>1;if(t.tagName==="BODY"){let u=document.documentElement;n=u.clientWidth,o=u.clientHeight;var p;e=(p=C?.width)!==null&&p!==void 0?p:n;var v;l=(v=C?.height)!==null&&v!==void 0?v:o,i.top=u.scrollTop||t.scrollTop,i.left=u.scrollLeft||t.scrollLeft,C&&(r=C.offsetTop,c=C.offsetLeft)}else({width:e,height:l,top:r,left:c}=B(t,!1)),i.top=t.scrollTop,i.left=t.scrollLeft,n=e,o=l;if(ge()&&(t.tagName==="BODY"||t.tagName==="HTML")&&d){i.top=0,i.left=0;var m;r=(m=C?.pageTop)!==null&&m!==void 0?m:0;var s;c=(s=C?.pageLeft)!==null&&s!==void 0?s:0}return{width:e,height:l,totalWidth:n,totalHeight:o,scroll:i,top:r,left:c}}function Ee(t){return{top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}}function te(t,e,l,n,o,r,c){var i;let h=(i=o.scroll[t])!==null&&i!==void 0?i:0,d=n[K[t]],p=n.scroll[M[t]]+r,v=d+n.scroll[M[t]]-r,m=e-h+c[t]-n[M[t]],s=e-h+l+c[t]-n[M[t]];return m<p?p-m:s>v?Math.max(v-s,p-m):0}function Pe(t){let e=window.getComputedStyle(t);return{top:parseInt(e.marginTop,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0,right:parseInt(e.marginRight,10)||0}}function le(t){if(Z[t])return Z[t];let[e,l]=t.split(" "),n=M[e]||"right",o=we[n];M[l]||(l="center");let r=K[n],c=K[o];return Z[t]={placement:e,crossPlacement:l,axis:n,crossAxis:o,size:r,crossSize:c},Z[t]}function q(t,e,l,n,o,r,c,i,h,d){let{placement:p,crossPlacement:v,axis:m,crossAxis:s,size:u,crossSize:g}=n,f={};var R;f[s]=(R=t[s])!==null&&R!==void 0?R:0;var a,w,x,T;v==="center"?f[s]+=(((a=t[g])!==null&&a!==void 0?a:0)-((w=l[g])!==null&&w!==void 0?w:0))/2:v!==s&&(f[s]+=((x=t[g])!==null&&x!==void 0?x:0)-((T=l[g])!==null&&T!==void 0?T:0)),f[s]+=r;const $=t[s]-l[g]+h+d,H=t[s]+t[g]-h-d;if(f[s]=J(f[s],$,H),p===m){const k=i?c[u]:e[ae[u]];f[U[m]]=Math.floor(k-t[m]+o)}else f[m]=Math.floor(t[m]+t[u]+o);return f}function Ce(t,e,l,n,o,r,c,i){const h=n?l.height:e[ae.height];var d;let p=t.top!=null?l.top+t.top:l.top+(h-((d=t.bottom)!==null&&d!==void 0?d:0)-c);var v,m,s,u,g,f;let R=i!=="top"?Math.max(0,e.height+e.top+((v=e.scroll.top)!==null&&v!==void 0?v:0)-p-(((m=o.top)!==null&&m!==void 0?m:0)+((s=o.bottom)!==null&&s!==void 0?s:0)+r)):Math.max(0,p+c-(e.top+((u=e.scroll.top)!==null&&u!==void 0?u:0))-(((g=o.top)!==null&&g!==void 0?g:0)+((f=o.bottom)!==null&&f!==void 0?f:0)+r));return Math.min(e.height-r*2,R)}function oe(t,e,l,n,o,r){let{placement:c,axis:i,size:h}=r;var d,p;if(c===i)return Math.max(0,l[i]-t[i]-((d=t.scroll[i])!==null&&d!==void 0?d:0)+e[i]-((p=n[i])!==null&&p!==void 0?p:0)-n[U[i]]-o);var v;return Math.max(0,t[h]+t[i]+t.scroll[i]-e[i]-l[i]-l[h]-((v=n[i])!==null&&v!==void 0?v:0)-n[U[i]]-o)}function Le(t,e,l,n,o,r,c,i,h,d,p,v,m,s,u,g){let f=le(t),{size:R,crossAxis:a,crossSize:w,placement:x,crossPlacement:T}=f,$=q(e,i,l,f,p,v,d,m,u,g),H=p,k=oe(i,d,e,o,r+p,f);if(c&&n[R]>k){let W=le(`${U[x]} ${T}`),de=q(e,i,l,W,p,v,d,m,u,g);oe(i,d,e,o,r+p,W)>k&&(f=W,$=de,H=p)}let _="bottom";f.axis==="top"?f.placement==="top"?_="top":f.placement==="bottom"&&(_="bottom"):f.crossAxis==="top"&&(f.crossPlacement==="top"?_="bottom":f.crossPlacement==="bottom"&&(_="top"));let y=te(a,$[a],l[w],i,h,r,d);$[a]+=y;let z=Ce($,i,d,m,o,r,l.height,_);s&&s<z&&(z=s),l.height=Math.min(l.height,z),$=q(e,i,l,f,H,v,d,m,u,g),y=te(a,$[a],l[w],i,h,r,d),$[a]+=y;let P={},L=e[a]-$[a]-o[M[a]],O=L+.5*e[w];const X=u/2+g;var S,N,F,I;const A=M[a]==="left"?((S=o.left)!==null&&S!==void 0?S:0)+((N=o.right)!==null&&N!==void 0?N:0):((F=o.top)!==null&&F!==void 0?F:0)+((I=o.bottom)!==null&&I!==void 0?I:0),Y=l[w]-A-u/2-g,G=e[a]+u/2-($[a]+o[M[a]]),ce=e[a]+e[w]-u/2-($[a]+o[M[a]]),se=J(O,G,ce);P[a]=J(se,X,Y),{placement:x,crossPlacement:T}=f,u?L=P[a]:T==="right"?L+=e[w]:T==="center"&&(L+=e[w]/2);let V=x==="left"||x==="top"?l[R]:0,fe={x:x==="top"||x==="bottom"?L:V,y:x==="left"||x==="right"?L:V};return{position:$,maxHeight:z,arrowOffsetLeft:P.left,arrowOffsetTop:P.top,placement:x,triggerAnchorPoint:fe}}function Re(t){let{placement:e,targetNode:l,overlayNode:n,scrollNode:o,padding:r,shouldFlip:c,boundaryElement:i,offset:h,crossOffset:d,maxHeight:p,arrowSize:v=0,arrowBoundaryOffset:m=0}=t,s=n instanceof HTMLElement?Te(n):document.documentElement,u=s===document.documentElement;const g=window.getComputedStyle(s).position;let f=!!g&&g!=="static",R=u?B(l,!1):ne(l,s,!1);if(!u){let{marginTop:P,marginLeft:L}=window.getComputedStyle(l);R.top+=parseInt(P,10)||0,R.left+=parseInt(L,10)||0}let a=B(n,!0),w=Pe(n);var x,T;a.width+=((x=w.left)!==null&&x!==void 0?x:0)+((T=w.right)!==null&&T!==void 0?T:0);var $,H;a.height+=(($=w.top)!==null&&$!==void 0?$:0)+((H=w.bottom)!==null&&H!==void 0?H:0);let k=Ee(o),_=ee(i),y=ee(s),z=i.tagName==="BODY"?B(s,!1):ne(s,i,!1);return s.tagName==="HTML"&&i.tagName==="BODY"&&(y.scroll.top=0,y.scroll.left=0),Le(e,R,a,k,w,r,c,_,y,z,h,d,f,p,v,m)}function Q(t,e){let{top:l,left:n,width:o,height:r}=t.getBoundingClientRect();return e&&t instanceof t.ownerDocument.defaultView.HTMLElement&&(o=t.offsetWidth,r=t.offsetHeight),{top:l,left:n,width:o,height:r}}function B(t,e){let{top:l,left:n,width:o,height:r}=Q(t,e),{scrollTop:c,scrollLeft:i,clientTop:h,clientLeft:d}=document.documentElement;return{top:l+c-h,left:n+i-d,width:o,height:r}}function ne(t,e,l){let n=window.getComputedStyle(t),o;if(n.position==="fixed")o=Q(t,l);else{o=B(t,l);let r=B(e,l),c=window.getComputedStyle(e);r.top+=(parseInt(c.borderTopWidth,10)||0)-e.scrollTop,r.left+=(parseInt(c.borderLeftWidth,10)||0)-e.scrollLeft,o.top-=r.top,o.left-=r.left}return o.top-=parseInt(n.marginTop,10)||0,o.left-=parseInt(n.marginLeft,10)||0,o}function Te(t){let e=t.offsetParent;if(e&&e===document.body&&window.getComputedStyle(e).position==="static"&&!re(e)&&(e=document.documentElement),e==null)for(e=t.parentElement;e&&!re(e);)e=e.parentElement;return e||document.documentElement}function re(t){let e=window.getComputedStyle(t);return e.transform!=="none"||/transform|perspective/.test(e.willChange)||e.filter!=="none"||e.contain==="paint"||"backdropFilter"in e&&e.backdropFilter!=="none"||"WebkitBackdropFilter"in e&&e.WebkitBackdropFilter!=="none"}const He=new WeakMap;function Se(t){let{triggerRef:e,isOpen:l,onClose:n}=t;E.useEffect(()=>{if(!l||n===null)return;let o=r=>{let c=r.target;if(!e.current||c instanceof Node&&!c.contains(e.current)||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement)return;let i=n||He.get(e.current);i&&i()};return window.addEventListener("scroll",o,!0),()=>{window.removeEventListener("scroll",o,!0)}},[l,n,e])}let b=typeof document<"u"?window.visualViewport:null;function Xe(t){let{direction:e}=he(),{arrowSize:l,targetRef:n,overlayRef:o,arrowRef:r,scrollRef:c=o,placement:i="bottom",containerPadding:h=12,shouldFlip:d=!0,boundaryElement:p=typeof document<"u"?document.body:null,offset:v=0,crossOffset:m=0,shouldUpdatePosition:s=!0,isOpen:u=!0,onClose:g,maxHeight:f,arrowBoundaryOffset:R=0}=t,[a,w]=E.useState(null),x=[s,i,o.current,n.current,r?.current,c.current,h,d,p,v,m,u,e,f,R,l],T=E.useRef(b?.scale);E.useEffect(()=>{u&&(T.current=b?.scale)},[u]);let $=E.useCallback(()=>{if(s===!1||!u||!o.current||!n.current||!p||b?.scale!==T.current)return;let P=null;if(c.current&&c.current.contains(document.activeElement)){var L;let A=(L=document.activeElement)===null||L===void 0?void 0:L.getBoundingClientRect(),Y=c.current.getBoundingClientRect();var O;if(P={type:"top",offset:((O=A?.top)!==null&&O!==void 0?O:0)-Y.top},P.offset>Y.height/2){P.type="bottom";var X;P.offset=((X=A?.bottom)!==null&&X!==void 0?X:0)-Y.bottom}}let S=o.current;if(!f&&o.current){var N;S.style.top="0px",S.style.bottom="";var F;S.style.maxHeight=((F=(N=window.visualViewport)===null||N===void 0?void 0:N.height)!==null&&F!==void 0?F:window.innerHeight)+"px"}let I=Re({placement:_e(i,e),overlayNode:o.current,targetNode:n.current,scrollNode:c.current||o.current,padding:h,shouldFlip:d,boundaryElement:p,offset:v,crossOffset:m,maxHeight:f,arrowSize:l??(r?.current?Q(r.current,!0).width:0),arrowBoundaryOffset:R});if(I.position){if(S.style.top="",S.style.bottom="",S.style.left="",S.style.right="",Object.keys(I.position).forEach(A=>S.style[A]=I.position[A]+"px"),S.style.maxHeight=I.maxHeight!=null?I.maxHeight+"px":"",P&&document.activeElement&&c.current){let A=document.activeElement.getBoundingClientRect(),Y=c.current.getBoundingClientRect(),G=A[P.type]-Y[P.type];c.current.scrollTop+=G-P.offset}w(I)}},x);j($,x),Ae($),D({ref:o,onResize:$}),D({ref:n,onResize:$});let H=E.useRef(!1);j(()=>{let P,L=()=>{H.current=!0,clearTimeout(P),P=setTimeout(()=>{H.current=!1},500),$()},O=()=>{H.current&&L()};return b?.addEventListener("resize",L),b?.addEventListener("scroll",O),()=>{b?.removeEventListener("resize",L),b?.removeEventListener("scroll",O)}},[$]);let k=E.useCallback(()=>{H.current||g?.()},[g,H]);Se({triggerRef:n,isOpen:u,onClose:g&&k});var _,y,z;return{overlayProps:{style:{position:a?"absolute":"fixed",top:a?void 0:0,left:a?void 0:0,zIndex:1e5,...a?.position,maxHeight:(_=a?.maxHeight)!==null&&_!==void 0?_:"100vh"}},placement:(y=a?.placement)!==null&&y!==void 0?y:null,triggerAnchorPoint:(z=a?.triggerAnchorPoint)!==null&&z!==void 0?z:null,arrowProps:{"aria-hidden":"true",role:"presentation",style:{left:a?.arrowOffsetLeft,top:a?.arrowOffsetTop}},updatePosition:$}}function Ae(t){j(()=>(window.addEventListener("resize",t,!1),()=>{window.removeEventListener("resize",t,!1)}),[t])}function _e(t,e){return e==="rtl"?t.replace("start","right").replace("end","left"):t.replace("start","left").replace("end","right")}const ye=E.createContext({});function je(){var t;return(t=E.useContext(ye))!==null&&t!==void 0?t:{}}function Ze(t){let[e,l]=be(t.isOpen,t.defaultOpen||!1,t.onOpenChange);const n=E.useCallback(()=>{l(!0)},[l]),o=E.useCallback(()=>{l(!1)},[l]),r=E.useCallback(()=>{l(!e)},[l,e]);return{isOpen:e,setOpen:l,open:n,close:o,toggle:r}}const ze=E.createContext({placement:"bottom"}),Ue=E.forwardRef(function(e,l){[e,l]=ue(e,l,ze);let n=e.placement,o={position:"absolute",transform:n==="top"||n==="bottom"?"translateX(-50%)":"translateY(-50%)"};n!=null&&(o[n]="100%");let r=pe({...e,defaultClassName:"react-aria-OverlayArrow",values:{placement:n}});r.style&&Object.keys(r.style).forEach(i=>r.style[i]===void 0&&delete r.style[i]);let c=$e(e);return ve.createElement("div",{...c,...r,style:{...o,...r.style},ref:l,"data-placement":n})});export{je as $,Ze as a,Be as b,Xe as c,Ye as d,ze as e,Ue as f,He as g,D as h};

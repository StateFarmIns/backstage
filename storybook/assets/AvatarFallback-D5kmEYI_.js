import{r as e,j as R}from"./iframe-BpNetfkk.js";import{u as f,a as x,N as A,b as L}from"./noop-C-zYH_zt.js";const h=e.createContext(void 0);function w(){const s=e.useContext(h);if(s===void 0)throw new Error("Base UI: AvatarRootContext is missing. Avatar parts must be placed within <Avatar.Root>.");return s}const p={imageLoadingStatus:()=>null},M=e.forwardRef(function(n,u){const{className:d,render:i,...o}=n,[t,a]=e.useState("idle"),c=e.useMemo(()=>({imageLoadingStatus:t}),[t]),l=e.useMemo(()=>({imageLoadingStatus:t,setImageLoadingStatus:a}),[t,a]),{renderElement:r}=f({render:i??"span",state:c,className:d,ref:u,extraProps:o,customStyleHookMapping:p});return R.jsx(h.Provider,{value:l,children:r()})});function P(s,{referrerPolicy:n,crossOrigin:u}){const[d,i]=e.useState("idle");return x(()=>{if(!s)return i("error"),A;let o=!0;const t=new window.Image,a=c=>()=>{o&&i(c)};return i("loading"),t.onload=a("loaded"),t.onerror=a("error"),n&&(t.referrerPolicy=n),t.crossOrigin=u??null,t.src=s,()=>{o=!1}},[s,u,n]),d}const I=e.forwardRef(function(n,u){const{className:d,render:i,onLoadingStatusChange:o,referrerPolicy:t,crossOrigin:a,...c}=n,l=w(),r=P(n.src,{referrerPolicy:t,crossOrigin:a}),m=L(v=>{o?.(v),l.setImageLoadingStatus(v)});x(()=>{r!=="idle"&&m(r)},[r,m]);const S=e.useMemo(()=>({imageLoadingStatus:r}),[r]),{renderElement:g}=f({render:i??"img",state:S,className:d,ref:u,extraProps:c,customStyleHookMapping:p});return r==="loaded"?g():null}),k=e.forwardRef(function(n,u){const{className:d,render:i,delay:o,...t}=n,{imageLoadingStatus:a}=w(),[c,l]=e.useState(o===void 0);e.useEffect(()=>{let g;return o!==void 0&&(g=window.setTimeout(()=>l(!0),o)),()=>{window.clearTimeout(g)}},[o]);const r=e.useMemo(()=>({imageLoadingStatus:a}),[a]),{renderElement:m}=f({render:i??"span",state:r,className:d,ref:u,extraProps:t,customStyleHookMapping:p});return a!=="loaded"&&c?m():null});export{M as A,I as a,k as b};

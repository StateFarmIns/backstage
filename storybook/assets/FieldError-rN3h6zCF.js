import{b as w,m as C,a as Q,j as k,c as h,$ as B,d as q}from"./utils-DLW_tb52.js";import{$ as Y}from"./useLabels-D6TP-BPt.js";import{s as z,b as G}from"./useFocusRing-BjAnfjlx.js";import{r as l,a4 as $,j as H}from"./iframe-DB3V3M1P.js";import{c as J}from"./clsx-B-dksMZM.js";import{u as K}from"./useStyles-0KSv8py2.js";function W(t){let{id:e,label:a,"aria-labelledby":i,"aria-label":o,labelElementType:n="label"}=t;e=w(e);let d=w(),s={};a&&(i=i?`${d} ${i}`:d,s={id:d,htmlFor:n==="label"?e:void 0});let v=Y({id:e,"aria-label":o,"aria-labelledby":i});return{labelProps:s,fieldProps:v}}function be(t){let{description:e,errorMessage:a,isInvalid:i,validationState:o}=t,{labelProps:n,fieldProps:d}=W(t),s=C([!!e,!!a,i,o]),v=C([!!e,!!a,i,o]);return d=Q(d,{"aria-describedby":[s,v,t["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:n,fieldProps:d,descriptionProps:{id:s},errorMessageProps:{id:v}}}const N={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},D={...N,customError:!0,valid:!1},b={isInvalid:!1,validationDetails:N,validationErrors:[]},j=l.createContext({}),F="__formValidationState"+Date.now();function pe(t){if(t[F]){let{realtimeValidation:e,displayValidation:a,updateValidation:i,resetValidation:o,commitValidation:n}=t[F];return{realtimeValidation:e,displayValidation:a,updateValidation:i,resetValidation:o,commitValidation:n}}return X(t)}function X(t){let{isInvalid:e,validationState:a,name:i,value:o,builtinValidation:n,validate:d,validationBehavior:s="aria"}=t;a&&(e||(e=a==="invalid"));let v=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:D}:null,c=l.useMemo(()=>{if(!d||o==null)return null;let u=Z(d,o);return L(u)},[d,o]);n?.validationDetails.valid&&(n=void 0);let r=l.useContext(j),f=l.useMemo(()=>i?Array.isArray(i)?i.flatMap(u=>M(r[u])):M(r[i]):[],[r,i]),[m,_]=l.useState(r),[S,E]=l.useState(!1);r!==m&&(_(r),E(!1));let V=l.useMemo(()=>L(S?[]:f),[S,f]),P=l.useRef(b),[y,g]=l.useState(b),p=l.useRef(b),O=()=>{if(!U)return;x(!1);let u=c||n||P.current;I(u,p.current)||(p.current=u,g(u))},[U,x]=l.useState(!1);return l.useEffect(O),{realtimeValidation:v||V||c||n||b,displayValidation:s==="native"?v||V||y:v||V||c||n||y,updateValidation(u){s==="aria"&&!I(y,u)?g(u):P.current=u},resetValidation(){let u=b;I(u,p.current)||(p.current=u,g(u)),s==="native"&&x(!1),E(!0)},commitValidation(){s==="native"&&x(!0),E(!0)}}}function M(t){return t?Array.isArray(t)?t:[t]:[]}function Z(t,e){if(typeof t=="function"){let a=t(e);if(a&&typeof a!="boolean")return M(a)}return[]}function L(t){return t.length?{isInvalid:!0,validationErrors:t,validationDetails:D}:null}function I(t,e){return t===e?!0:!!t&&!!e&&t.isInvalid===e.isInvalid&&t.validationErrors.length===e.validationErrors.length&&t.validationErrors.every((a,i)=>a===e.validationErrors[i])&&Object.entries(t.validationDetails).every(([a,i])=>e.validationDetails[a]===i)}function Ee(t,e,a){let{validationBehavior:i,focus:o}=t;k(()=>{if(i==="native"&&a?.current&&!a.current.disabled){let c=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";a.current.setCustomValidity(c),a.current.hasAttribute("title")||(a.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(ae(a.current))}});let n=l.useRef(!1),d=h(()=>{n.current||e.resetValidation()}),s=h(c=>{var r;e.displayValidation.isInvalid||e.commitValidation();let f=a==null||(r=a.current)===null||r===void 0?void 0:r.form;if(!c.defaultPrevented&&a&&f&&te(f)===a.current){var m;o?o():(m=a.current)===null||m===void 0||m.focus(),z("keyboard")}c.preventDefault()}),v=h(()=>{e.commitValidation()});l.useEffect(()=>{let c=a?.current;if(!c)return;let r=c.form,f=r?.reset;return r&&(r.reset=()=>{n.current=!window.event||window.event.type==="message"&&window.event.target instanceof MessagePort,f?.call(r),n.current=!1}),c.addEventListener("invalid",s),c.addEventListener("change",v),r?.addEventListener("reset",d),()=>{c.removeEventListener("invalid",s),c.removeEventListener("change",v),r?.removeEventListener("reset",d),r&&(r.reset=f)}},[a,s,v,d,i])}function ee(t){let e=t.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function ae(t){return{isInvalid:!t.validity.valid,validationDetails:ee(t),validationErrors:t.validationMessage?[t.validationMessage]:[]}}function te(t){for(let e=0;e<t.elements.length;e++){let a=t.elements[e];if(!a.validity.valid)return a}return null}const ie=l.createContext({}),re=l.forwardRef(function(e,a){[e,a]=B(e,a,ie);let{elementType:i="span",...o}=e;return $.createElement(i,{className:"react-aria-Text",...o,ref:a})}),T=l.createContext(null),le=l.forwardRef(function(e,a){let i=l.useContext(T);return i?.isInvalid?$.createElement(oe,{...e,ref:a}):null}),oe=l.forwardRef((t,e)=>{let a=l.useContext(T),i=G(t,{global:!0}),o=q({...t,defaultClassName:"react-aria-FieldError",defaultChildren:a.validationErrors.length===0?void 0:a.validationErrors.join(" "),values:a});return o.children==null?null:$.createElement(re,{slot:"errorMessage",...i,...o,ref:e})}),R=l.createContext(null),Ve=l.forwardRef(function(e,a){[e,a]=B(e,a,R);let{validationErrors:i,validationBehavior:o="native",children:n,className:d,...s}=e;return $.createElement("form",{noValidate:o!=="native",...s,ref:a,className:d||"react-aria-Form"},$.createElement(R.Provider,{value:{...e,validationBehavior:o}},$.createElement(j.Provider,{value:i??{}},n)))}),ne={"bui-FieldError":"_bui-FieldError_1mn73_18"},A=l.forwardRef((t,e)=>{const{classNames:a,cleanedProps:i}=K("FieldError",t),{className:o,...n}=i;return H.jsx(le,{className:J(a.root,ne[a.root],o),ref:e,...n})});A.displayName="FieldError";A.__docgenInfo={description:"@public",methods:[],displayName:"FieldError"};export{Ve as $,A as F,R as a,ie as b,T as c,pe as d,be as e,Ee as f,W as g,re as h,F as i,b as j};
